def solution(s, lst):
    def fibonacci(n):
        if n <= 0:
            return 0
        elif n == 1:
            return 1
        a, b = 0, 1
        for _ in range(2, n + 1):
            a, b = b, a + b
        return b

    def odd_factors(n):
        factors = []
        for i in range(1, n + 1):
            if n % i == 0 and i % 2 != 0:
                factors.append(i)
        return sorted(factors)

    capitalized_words = [word for word in s.split() if word[0].isupper()]
    count = len(capitalized_words)

    if count % 2 == 0:
        nth_fib = fibonacci(count)
        for row in lst:
            row[-1] += nth_fib
    else:
        factors = odd_factors(count)
        for row in lst:
            row[-1] = factors.pop(0) if factors else 0
    
    return lst